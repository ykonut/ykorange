---
{"dg-publish":true,"permalink":"/ğŸ”è®¡é‡ç»æµå­¦/å›å½’çš„å‡ ä½•æ„ä¹‰/","tags":["çº¿æ€§æ¨¡å‹"],"created":"2025-01-08T17:29:15.000+08:00","updated":"2025-08-20T16:14:14.858+08:00"}
---


çŸ©é˜µå½¢å¼çš„æ ·æœ¬å›å½’æ–¹ç¨‹å†™ä½œ
$$
\mathbf{Y}=\mathbf{X}\hat{{\beta}}+\mathbf{e}
$$
è€ƒè™‘è‡ªå˜é‡çŸ©é˜µåˆ†å— $\mathbf{X}=[\mathbf{X}_1,\cdots,\mathbf{X}_k]$ ï¼Œå…¶ä¸­ $\mathbf{X}_j$ ä¸ºç¬¬ $j$ ä¸ªè‡ªå˜é‡å‘é‡ï¼Œæ¯ä¸ªè‡ªå˜é‡å‘é‡çš„ç»´æ•°éƒ½ä¸º $n$ï¼Œå› æ­¤ $\mathbf{X}b$ å¯ä»¥è¡¨ç¤º $k$ ä¸ªå‘é‡åœ¨ $n$ ç»´ç©ºé—´çš„å¼ æˆç©ºé—´ï¼Œå³ $span(\mathbf{X}_{1},\dots,\mathbf{X}_{k})\in \mathbb{R}^n$ï¼›Linear Projection å³åœ¨å¼ æˆç©ºé—´å†…æ‰¾åˆ°ä¸€ä¸ªè·ç¦» $\mathbf{Y}$ è·ç¦»æœ€è¿‘çš„å‘é‡å®šä¹‰ä¸º $\hat{\mathbf{Y}}$ã€‚æ¢è¨€ä¹‹ï¼Œè®¾å®š $\mathbf{Y}$ åœ¨ $span(\mathbf{X})$ ä¸Šçš„æŠ•å½±ä¸º $\hat{\mathbf{Y}}$ï¼ˆè¿™æ˜¯å› ä¸ºæŠ•å½±çš„è·ç¦»æœ€è¿‘ï¼‰ï¼Œä¹Ÿå°±æ˜¯å‘é‡ $\mathbf{X}\hat{{\beta}}$ ï¼ŒäºŒè€…çš„è·ç¦»ä¸º $\lvert \mathbf{e} \rvert$

æ ¹æ®ç«‹ä½“å‡ ä½•åŸç†ï¼Œ$\mathbf{e}$ åº”å½“å‚ç›´äºæ•´ä¸ªå¼ æˆç©ºé—´ï¼Œå› æ­¤
$$
\begin{align}
\mathbf{X}^{\mathsf{T}}\mathbf{e}&=\mathbf{0}_{{k\times 1}} \\
\mathbf{X}^{\mathsf{T}}(\mathbf{Y}-\mathbf{X}\hat{{\beta}})&=\mathbf{0} \\
\mathbf{X}^{\mathsf{T}}\mathbf{Y}&=\mathbf{X}^{\mathsf{T}}\mathbf{X}\hat{{\beta}} \\
\hat{{\beta}}&=\left(\mathbf{X}^{\mathsf{T}}\mathbf{X} \right)^{-1}\left(\mathbf{X}^{\mathsf{T}}\mathbf{Y} \right)
\end{align}
$$
è¿™é‡Œç›¸å½“äºä¸º [[ğŸ”è®¡é‡ç»æµå­¦/Moment Estimation\|Moment Estimation]] èµ‹äºˆäº†ä¸€ç§å‡ ä½•æ„ä¹‰ã€‚

## Projection Matrix

å®šä¹‰æŠ•å½±çŸ©é˜µ
$$
\mathbf{P}\equiv \mathbf{X}(\mathbf{X}^{\mathsf{T}}\mathbf{X})^{-1}\mathbf{X}^{\mathsf{T}}
$$
æ˜¾ç„¶ï¼ŒæŠ•å½±çŸ©é˜µå¯¹ $\mathbf{X}$ æœ‰ç±»ä¼¼Ã—1çš„æ•ˆæœ
$$
\mathbf{PX}=\mathbf{X}(\mathbf{X}^{\mathsf{T}}\mathbf{X})^{-1}\mathbf{X}^{\mathsf{T}}\mathbf{X}=\mathbf{X}
$$
äº‹å®ä¸Šï¼ŒæŠ•å½±çŸ©é˜µå¯¹ä»»æ„ $\mathbf{Z}=\mathbf{X\Gamma}$ æœ‰ç±»ä¼¼Ã—1 çš„æ•ˆæœ
$$
\mathbf{PZ}=\mathbf{X}(\mathbf{X}^{\mathsf{T}}\mathbf{X})^{-1}\mathbf{X}^{\mathsf{T}}\mathbf{X}\boldsymbol{\Gamma}=\mathbf{Z}
$$
ç‰¹åˆ«åœ°
$$
\begin{gather}
\mathbf{PY}=\mathbf{X(X^{\mathsf{T}} X)^{-1}X^{\mathsf{T}}}\mathbf{Y}=\mathbf{X}\hat{{\beta}}=\hat{\mathbf{Y}} \\
\mathbf{Pe}=\mathbf{P}(\mathbf{Y}-\mathbf{X}\hat{{\beta}})=\hat{\mathbf{Y}}-\mathbf{X}\hat{{\beta}}=\mathbf{0}
\end{gather}
$$
æ€»ä¹‹ï¼ŒæŠ•å½±çš„çŸ©é˜µçš„å‡ ä½•æ„ä¹‰æ˜¯ç»™å‡ºä»»æ„ä¸€ä¸ªå‘é‡åœ¨ $span(\mathbf{X})$ çš„æŠ•å½±å‘é‡ï¼Œè‹¥ä½œç”¨åœ¨æœ¬å°±å¤„äºå¼ æˆç©ºé—´å†…çš„å‘é‡è‡ªç„¶å°±æœ‰è¿˜åŸæ•ˆæœã€‚

æŠ•å½±çŸ©é˜µçš„é‡è¦æ€§è´¨ï¼šå¯¹ç§°å¹‚ç­‰
- $\mathbf{P}$ is symmetric ($\mathbf{P^{\mathsf{T}}}=\mathbf{P}$)
- $\mathbf{P}$ is idempotent ($\mathbf{PP}=\mathbf{P}$)ï¼ˆå¹‚ç­‰ï¼‰

æŠ•å½±çŸ©é˜µçš„è¿¹ï¼š
$$
\begin{align}
\mathrm{Tr}(\mathbf{P})
&=\mathrm{Tr}(\mathbf{X}(\mathbf{X}^{\mathsf{T}}\mathbf{X})^{-1}\mathbf{X}^{\mathsf{T}}) \\
&=\mathrm{Tr}((\mathbf{X}^{\mathsf{T}}\mathbf{X})^{-1}\mathbf{X}^{\mathsf{T}}\mathbf{X}) \\
&=\mathrm{Tr}(\mathbf{I}_{k}) \\
&=k
\end{align}
$$
 (refer [[ğŸ”è®¡é‡ç»æµå­¦/Trace Operator\|Trace Operator]])
æŠ•å½±çŸ©é˜µçš„è¿¹è¡¨ç¤ºäº†æŠ•å½±çš„ç»´åº¦ï¼Œå¤§å°å–å†³äº $span(\mathbf{X})$ çš„ç»´åº¦
## Annihilator Matrix

å®šä¹‰æ¶ˆé™¤çŸ©é˜µ
$$
\mathbf{M}\equiv \mathbf{I}_n-\mathbf{P}=\mathbf{I}_n-\mathbf{X}(\mathbf{X}^{\mathsf{T}}\mathbf{X})^{-1}\mathbf{X}^{\mathsf{T}}
$$
æ˜¾ç„¶ï¼Œæ¶ˆé™¤çŸ©é˜µå¯¹ $\mathbf{X}$ æœ‰ç±»ä¼¼ Ã—0 çš„æ•ˆæœ
$$
\mathbf{MX}=(\mathbf{I}_n-\mathbf{P})\mathbf{X}=\mathbf{X}-\mathbf{PX}=\mathbf{X}
-\mathbf{X}=\mathbf{0}$$
äº‹å®ä¸Šï¼Œæ¶ˆé™¤çŸ©é˜µå¯¹ä»»æ„ $\mathbf{Z}=\mathbf{X\Gamma}$ æœ‰ç±»ä¼¼ Ã—0 çš„æ•ˆæœ
$$
\mathbf{MZ}=\mathbf{Z}-\mathbf{PZ}=\mathbf{Z}-\mathbf{Z}=\mathbf{0}
$$
ç‰¹åˆ«åœ°
$$
\begin{gather}
\mathbf{MY}=\mathbf{Y}-\mathbf{PY}=\mathbf{Y}-\hat{\mathbf{Y}}=\mathbf{e} \\
\mathbf{Me}=\mathbf{M}(\mathbf{Y}-\mathbf{X}{\beta})=\mathbf{e-0}=\mathbf{e}
\end{gather}
$$
æ€»ä¹‹ï¼Œæ¶ˆé™¤çŸ©é˜µçš„å‡ ä½•æ„ä¹‰æ˜¯ç»™å‡ºä»»æ„ä¸€ä¸ªå‘é‡åˆ° $span(\mathbf{X})$ çš„è·ç¦»å‘é‡ï¼Œè‹¥ä½œç”¨åœ¨æœ¬å°±å¤„äºå¼ æˆç©ºé—´å†…çš„å‘é‡å°±å¾—åˆ°é›¶å‘é‡ã€‚

æ¶ˆé™¤çŸ©é˜µçš„é‡è¦æ€§è´¨ï¼šå¯¹ç§°å¹‚ç­‰
- $\mathbf{M}$ is symmetric ($\mathbf{M^{\mathsf{T}}}=\mathbf{M}$)
- $\mathbf{M}$ is idempotent ($\mathbf{MM}=\mathbf{M}$)ï¼ˆå¹‚ç­‰ï¼‰

æ¶ˆé™¤çŸ©é˜µçš„è¿¹ï¼š
$$
\begin{align}
\mathrm{Tr}(\mathbf{M})&=\mathrm{Tr}(\mathbf{I}_{n}-\mathbf{P}) \\
&=\mathrm{Tr}(\mathbf{I}_{n})-\mathrm{Tr}(\mathbf{X}(\mathbf{X}^{\mathsf{T}}\mathbf{X})^{-1}\mathbf{X}^{\mathsf{T}}) \\
&=\mathrm{Tr}(\mathbf{I}_{n})-\mathrm{Tr}((\mathbf{X}^{\mathsf{T}}\mathbf{X})^{-1}\mathbf{X}^{\mathsf{T}}\mathbf{X}) \\
&=\mathrm{Tr}(\mathbf{I}_{n})-\mathrm{Tr}(\mathbf{I}_{k}) \\
&=n-k
\end{align}
$$
 (refer [[ğŸ”è®¡é‡ç»æµå­¦/Trace Operator\|Trace Operator]])

æ¶ˆé™¤çŸ©é˜µçš„è¿¹è¡¨ç¤ºäº†æ¶ˆé™¤çš„ç»´åº¦ï¼Œå¤§å°å–å†³äºåˆ°åº•æ¶ˆé™¤äº†å¤šæ•°ä¿¡æ¯ã€‚ä¸€èˆ¬åœ°ï¼Œè‹¥ä¸å­˜åœ¨å®Œå…¨å…±çº¿æ€§ï¼Œæ¶ˆå» $m$ ä¸ªè‡ªå˜é‡ä¿¡æ¯çš„æ¶ˆé™¤çŸ©é˜µçš„è¿¹ä¸º
$$
\mathrm{Tr}(\mathbf{M}_{\setminus m})=n-m
$$

## P/M Matrix of Constant

ç‰¹åˆ«åœ°ï¼Œä»¤ $\mathbf{X}=\mathbf{1}_{n}$ ï¼ŒæŠ•å½±çŸ©é˜µå’Œæ¶ˆé™¤çŸ©é˜µä¸º
$$
\begin{align}
\mathbf{P}_{0}&=\mathbf{1}_{n}\left( \mathbf{1}_{n}^{\mathsf{T}}\mathbf{1}_{n} \right)^{-1}\mathbf{1}_{n}^{\mathsf{T}} \\
\mathbf{M}_{0}&=\mathbf{I}_{n}-\mathbf{P}_{0}=\mathbf{I}_{n}-\mathbf{1}_{n}\left( \mathbf{1}_{n}^{\mathsf{T}}\mathbf{1}_{n} \right)^{-1}\mathbf{1}_{n}^{\mathsf{T}}
\end{align}
$$
> è€ƒè™‘ $\mathbf{P}_{0}$ çš„å®šä¹‰ï¼Œ$(\mathbf{1}^{\mathsf{T}}_n \mathbf{1}_n)^{-1}=\frac{1}{n}$ è€Œ $\mathbf{1}_{n}\mathbf{1}_{n}^{\mathsf{T}}$ æ˜¯ä¸€ä¸ªæ‰€æœ‰å…ƒç´ å…¨ä¸º 1 çš„ nÃ—n çŸ©é˜µï¼Œåè€…å³ä¹˜ä»»æ„ nÃ—1 çš„åˆ—å‘é‡éƒ½å¾—åˆ°æ‰€æœ‰å…ƒç´ éƒ½ä¸º n ç»´æ±‚å’Œå€¼åˆ—å‘é‡ï¼Œå†ä¹˜ $\frac{1}{n}$ å°±å¾—åˆ° n ç»´å¹³å‡å€¼åˆ—å‘é‡ï¼›ç±»ä¼¼åœ°ï¼Œå³ä¹˜ä»»æ„ nÃ—k çš„çŸ©é˜µå°±å¾—åˆ° nÃ—k çš„å¹³å‡å€¼çŸ©é˜µï¼ˆå‡å€¼åœ¨åˆ—æ–¹å‘ä¸Šå–ï¼‰ã€‚å› æ­¤ï¼Œ$\mathbf{M}_{0}$ çŸ©é˜µå³ä¹˜ä»»æ„ nÃ—k çŸ©é˜µå¾—åˆ° nÃ—k çš„å»å‡å€¼çŸ©é˜µã€‚

å®šä¹‰ $\bar{\mathbf{X}}_{i}=\mathbf{1}_{n}\bar{X}_{i}$ ï¼Œåˆ™æœ‰
$$
\begin{align}
\mathbf{P}_{0}\mathbf{X}&=
\begin{bmatrix}
\bar{\mathbf{X}}_{1}&\dots&\bar{\mathbf{X}}_{k}
\end{bmatrix} \\
\mathbf{M}_{0}\mathbf{X}&=\begin{bmatrix}
(\mathbf{X}_{1}-\bar{\mathbf{X}}_{1})&\dots&(\mathbf{X}_{k}-\bar{\mathbf{X}}_{k})
\end{bmatrix} \\
\mathbf{P}_{0}\mathbf{e}&=\bar{\mathbf{e}}=\mathbf{0} \\
\mathbf{M}_{0}\mathbf{e}&=\mathbf{e}
\end{align}
$$
ç”±æ­¤å¯ä»¥è¯æ˜å‡å€¼ç‚¹åœ¨å›å½’çº¿ä¸Š
$$
\bar{\mathbf{Y}}=\mathbf{P}_{0}\mathbf{Y}=\mathbf{P}_{0}(\mathbf{X}{\beta}+\mathbf{e})=\bar{\mathbf{X}}{\beta}\implies \bar{Y}=\begin{bmatrix}
\bar{X}_{1}&\dots&\bar{X}_{k}
\end{bmatrix}{\beta}
$$
ä»¥åŠæ‹Ÿåˆå€¼å‡å€¼ç­‰äºçœŸå€¼å‡å€¼
$$
\bar{\mathbf{Y}}=\mathbf{P}_{0}\mathbf{Y}=\mathbf{P}_{0}(\hat{\mathbf{Y}}+\mathbf{e})=\mathbf{P}_{0}\hat{\mathbf{Y}}\implies \bar{Y}=\bar{\hat{Y}}
$$
æŠ•å½±çŸ©é˜µå’Œæ¶ˆé™¤çŸ©é˜µçš„è¿¹ä¸º
$$
\begin{align}
\mathrm{Tr}(\mathbf{P}_{0})&=\mathrm{Tr}(1)=1 \\
\mathrm{Tr}(\mathbf{M}_{0})&=\mathrm{Tr}(\mathbf{I}_{n})-\mathrm{Tr}(1)=n-1
\end{align}
$$
