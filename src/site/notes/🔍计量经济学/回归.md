---
{"dg-publish":true,"permalink":"/ğŸ”è®¡é‡ç»æµå­¦/å›å½’/","tags":["å› æœæ¨æ–­"],"created":"2025-01-05T17:06:24.000+08:00","updated":"2025-08-20T16:14:50.497+08:00"}
---

[[ğŸ”è®¡é‡ç»æµå­¦/åˆ†å±‚\|åˆ†å±‚]]å’Œ[[ğŸ”è®¡é‡ç»æµå­¦/åŒ¹é…\|åŒ¹é…]]éƒ½æ˜¯éå‚æ•°ä¼°è®¡æ–¹æ³•ï¼Œå¹¶æœªå¯¹æ•°æ®ç”Ÿæˆè¿‡ç¨‹ä½œå‡ºå‡è®¾ã€‚

å®šä¹‰ï¼š
- outcome $Y$
- binary treatment $D$
- discrete covariates $X$

è€ƒè™‘å¦‚ä¸‹ [[ğŸ”è®¡é‡ç»æµå­¦/Linear Regression Model\|Linear Regression Model]]ï¼ˆçœç•¥äº†è§„èŒƒæ€§æ¡ä»¶ï¼‰ï¼š
$$
Y=\tau_{R}D+X^{\mathsf{T}}\beta+e
$$
æ ¹æ® [[ğŸ”è®¡é‡ç»æµå­¦/Frisch-Waugh-Lovell Theorem\|Frisch-Waugh-Lovell Theorem]] å¯çŸ¥ï¼Œ$\tau_{R}$ ä¹Ÿç›¸å½“äº $Y$ å¯¹ $\tilde{D}$ å›å½’çš„ç³»æ•°ã€‚å…¶ä¸­ï¼Œ$\tilde{D}$ æ˜¯ [[ğŸ”è®¡é‡ç»æµå­¦/Linear Projection Model\|Linear Projection Model]] $D=X^{\mathsf{T}}\beta'+\tilde{D}$ å½“ä¸­çš„ Projection Errorã€‚ä¸è¿‡ï¼Œæ ¹æ®æ¡ä»¶æœŸæœ›çš„å®šä¹‰ï¼Œ$X$ æ˜¯ç¦»æ•£å˜é‡å°±æ„å‘³ç€ $E[D\mid X]=X^{\mathsf{T}}\beta'$ï¼Œå³æ¡ä»¶æœŸæœ›å‡½æ•°å¿…ç„¶æ˜¯çº¿æ€§çš„ã€‚å› æ­¤ $\tilde{D}=D-E[D\mid X]$ï¼Œå³ $\tilde{D}$ è¿˜æ˜¯ [[ğŸ”è®¡é‡ç»æµå­¦/çº¿æ€§CEFæ¨¡å‹#CEF Error\|CEF Error]]ï¼Œä¹Ÿå°±æ»¡è¶³ç›¸å…³æ€§è´¨ã€‚å¦‚æœ $X$ æ˜¯è¿ç»­å˜é‡ï¼Œè¦ä½¿ç”¨ CEF Error çš„ç›¸å…³æ€§è´¨å°±éœ€è¦æ˜ç¡®å‡è®¾ $E[D\mid X]$ å…³äº $X$ æ˜¯çº¿æ€§çš„äº†ã€‚

æ ¹æ® [[ğŸ”è®¡é‡ç»æµå­¦/Linear Regression Model#æ±‚è§£å‚æ•°\|Linear Regression Model#æ±‚è§£å‚æ•°]] å¯çŸ¥
$$
\tau_{R} =\frac{E[\tilde{D}Y]}{E[\tilde{D}^{2}]}=\frac{E[\tilde{D}E(Y\mid \tilde{D})]}{E[\tilde{D}^{2}]}=\frac{E[\tilde{D}E(Y\mid D,X)]}{E[\tilde{D}^{2}]}
$$
åˆ©ç”¨[[ğŸ”è®¡é‡ç»æµå­¦/æ½œåœ¨ç»“æœæ¡†æ¶\|æ½œåœ¨ç»“æœæ¡†æ¶]]ï¼Œå®šä¹‰
$$
\Delta(X)\equiv E(Y\mid D=1,X)-E(Y\mid D=0,X)
$$
ä»è€Œæœ‰
$$
E(Y\mid D,X)=E(Y\mid D=0,X)+D\Delta(X)
$$
ä»£å…¥ $\tau_{R}$ å¯å¾—
$$
\begin{align}
\tau_{R} & =\frac{E[\tilde{D}E(Y\mid D,X)]}{E[\tilde{D}^{2}]} \\
 & =\frac{E[\tilde{D}E(Y\mid D=0,X)]}{E[\tilde{D}^{2}]}+\frac{E[\tilde{D}D\Delta(X)]}{E[\tilde{D}^{2}]} \\
 & =\frac{E[\tilde{D}D\Delta(X)]}{E[\tilde{D}^{2}]} \\
 & =\frac{E[E(\tilde{D}D\mid X)\Delta(X)]}{E[E(\tilde{D}^{2}\mid X)]}
\end{align}
$$
å…¶ä¸­ï¼Œ$E(Y\mid D=0,X)$ æ˜¯å…³äº $X$ çš„å‡½æ•°ï¼Œæ ¹æ® [[ğŸ”è®¡é‡ç»æµå­¦/çº¿æ€§CEFæ¨¡å‹#CEF Error\|CEF Error]] çš„æ€§è´¨å¯çŸ¥è¯¥é¡¹ä¸ºé›¶ã€‚

å¼•ç†ï¼š
$$
E(\tilde{D}D\mid X)=E(\tilde{D}^{2}\mid X)=E\{ [D-E(D\mid X)]^{2}\mid X \}=Var(D\mid X)
$$
è¯æ˜ï¼š$\tilde{D}$ å®šä¹‰å¼ä¸¤è¾¹åŒæ—¶ä¹˜ä¸Š $\tilde{D}$ å¹¶å–æœŸæœ›å¯å¾—
$$
\begin{align}
\tilde{D}^{2} & =\tilde{D}D-\tilde{D}E[D\mid X] \\
E[\tilde{D}^{2}] & =E[\tilde{D}D]-E[\tilde{D}E(D\mid X)] \\
E[E(\tilde{D}^{2}\mid X)] & =E[E(\tilde{D}D\mid X)]
\end{align}
$$
å…¶ä¸­ï¼Œ$E(D\mid X)$ æ˜¯å…³äº $X$ çš„å‡½æ•°ï¼Œæ ¹æ® [[ğŸ”è®¡é‡ç»æµå­¦/çº¿æ€§CEFæ¨¡å‹#CEF Error\|CEF Error]] çš„æ€§è´¨å¯çŸ¥å¯çŸ¥è¯¥é¡¹ä¸ºé›¶ï¼Œç¬¬ä¸€ä¸ªç­‰å¼æˆç«‹ï¼›ä»£å…¥ $\tilde{D}$ çš„å®šä¹‰å¼å³å¯å¾—åˆ°å‰©ä½™ç­‰å¼ã€‚è¯æ¯•ã€‚

å¼•ç†ä»£å…¥ $\tau_{R}$ å¯å¾—
$$
\tau_{R}=\frac{E[Var(D\mid X)\Delta(X)]}{E[Var(D\mid X)]}
$$
å¯è§å›å½’è¢«ä¼°é‡ $\tau_{R}$ ç›¸å½“äº $\Delta(X=x)$ æ ¹æ® $Var(D\mid X)$ åŠ æƒçš„å¹³å‡å€¼ã€‚å…¶ä¸­ï¼Œ$D$ æ˜¯ä¸€ä¸ªæœä»äºŒé¡¹åˆ†å¸ƒçš„éšæœºå˜é‡ï¼Œå› æ­¤ $Var(D\mid X)=P(D=1\mid X)[1-P(D=1\mid X)]$ï¼Œäºæ˜¯
$$
\tau_{R}=\frac{\sum \Delta(X=x)P(D=1\mid X=x)[1-P(D=1\mid X=x)]P(X=x)}{\sum P(D=1\mid X=x)[1-P(D=1\mid X=x)]P(X=x)}
$$
å¯¹æ¯”[[ğŸ”è®¡é‡ç»æµå­¦/åŒ¹é…\|åŒ¹é…]]è¢«ä¼°é‡ï¼Œä½¿ç”¨è´å¶æ–¯å…¬å¼å’Œå…¨æ¦‚ç‡å…¬å¼å¯å¾—
$$
\tau_{M}=\sum\Delta(X=x)P(X=x\mid D=1)=\frac{\sum\Delta(X=x)P(D=1\mid X=x)P(X=x)}{\sum P(D=1\mid X=x)P(X=x)}
$$
ç”±æ­¤å¯è§ï¼Œå›å½’å’ŒåŒ¹é…éƒ½æ˜¯ $\Delta(X)$ çš„å¹³å‡å€¼ï¼Œå›å½’æ˜¯åŠ æƒå¹³å‡å€¼ï¼ŒåŒ¹é…åˆ™æ˜¯ç®—æœ¯å¹³å‡å€¼ã€‚ä¾‹å¦‚ï¼Œ$P(D=1\mid X=x)=\frac{1}{2}$ æ—¶ $Var(D\mid X)$ æœ€å¤§ï¼Œå³å›å½’ä¼šå°†æœ€å¤§æƒé‡èµ‹äºˆå¤„ç†ç»„å’Œæ§åˆ¶ç»„æ•°é‡ç›¸åŒçš„å±‚ã€‚

ç»“åˆ[[ğŸ”è®¡é‡ç»æµå­¦/æ½œåœ¨ç»“æœæ¡†æ¶\|æ½œåœ¨ç»“æœæ¡†æ¶]]ï¼Œå¦‚æœæ»¡è¶³å¼ºå¯å¿½ç•¥æ€§å‡è®¾ï¼Œåˆ™
$$
\Delta(X)=ATT(X)=ATU(X)=ATE(X)
$$
è¿›ä¸€æ­¥ï¼Œå¦‚æœ $\Delta(X)$ ä¸ºå¸¸æ•°ï¼ˆè¿™å¾ˆå›°éš¾ï¼‰ï¼Œåˆ™å›å½’å’ŒåŒ¹é…è¢«ä¼°é‡ç»“æœå®Œå…¨ç›¸åŒã€‚